
<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta http-equiv="x-ua-compatible" content="ie=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>Who‚Äôs On First | Boundary Issues: Editing Properties in Who&#39;s On First Records</title>
		<meta name="description" content="Who‚Äôs on First is a gazetteer of places." />
		<link rel="apple-touch-icon" href="/images/favicons/apple-touch-icon.png" sizes="180x180" />
		<link rel="icon" type="image/png" href="/images/favicons/favicon-16x16.png" sizes="16x16" />
		<link rel="icon" type="image/png" href="/images/favicons/favicon-32x32.png" sizes="32x32" />
		<link rel="manifest" href="/images/favicons/manifest.json" />
		<link rel="mask-icon" href="/images/favicons/safari-pinned-tab.svg" color="#2C1E3F" />
		<link rel="stylesheet" href="/css/bootstrap.min.css" />
		<link rel="stylesheet" href="/css/mapzen.whosonfirst.css" />
		
		<link rel="stylesheet" href="/css/styles/grayscale.css" />

		<link rel="alternate" type="application/atom+xml" title="Who's On First Atom feed" href="/blog/atom_10.xml"/>		
		<link rel="alternate" type="application/rss+xml" title="Who's On First RSS 2.0 feed" href="/blog/rss_20.xml"/>

		
		<meta property="og:type" content="article" />
		<meta property="og:site_name" content="Who's On First" />
		<meta property="og:title" content="Boundary Issues: Editing Properties in Who&#39;s On First Records" />
		<meta property="og:description" content="Introducing our bespoke web-based editor for Who&#39;s On First records‚Äîhelping GeoJSON help you." />
		<meta property="og:image" content="https://www.whosonfirst.org/blog/2016/10/05/boundary-issues-properties/images/grouped-properties.gif" />
		
		<meta property="twitter:card" value="summary" />
		<meta property="twitter:site" content="@alloftheplaces" />
		<meta property="twitter:creator" content="@alloftheplaces" />
		<meta property="twitter:url" content="https://www.whosonfirst.org/blog/2016/10/05/boundary-issues-properties/" />
		<meta property="twitter:title" content="Boundary Issues: Editing Properties in Who&#39;s On First Records" />
		<meta property="twitter:description" content="Introducing our bespoke web-based editor for Who&#39;s On First records‚Äîhelping GeoJSON help you." />
		<meta property="twitter:image" content="https://www.whosonfirst.org/blog/2016/10/05/boundary-issues-properties/images/grouped-properties.gif" />
		

	</head>
	<body>
		<div class="whosonfirst-wrapper">

			<nav class="navbar navbar-default navbar-fixed-top whosonfirst-fixed-subpage-navbar">
				<div class="container">

					
					<div class="navbar-header">
						<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
							<span class="sr-only">Toggle navigation</span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
						</button>
						<a class="navbar-brand" href="/">Who‚Äôs On First</a>
					</div>

					
					<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
					  <ul class="nav navbar-nav navbar-right">

							<li class="whosonfirst-navbar-element-collapsed">
								<a href="/browse/" class="whosonfirst-nav-link whosonfirst-nav-link-collapsed">browse</a>
							</li>
					    
							<li class="whosonfirst-navbar-element-collapsed">
								<a href="/docs/" class="whosonfirst-nav-link whosonfirst-nav-link-collapsed">documentation</a>
							</li>
							
							<li class="whosonfirst-navbar-element-collapsed">
								<a href="/code/" class="whosonfirst-nav-link whosonfirst-nav-link-collapsed">code</a>
							</li>

							
							
							<li class="whosonfirst-navbar-element-collapsed">
								<a href="/download/" class="whosonfirst-nav-link whosonfirst-nav-link-collapsed">download</a>
							</li>
							
							<li class="whosonfirst-navbar-element-collapsed">
								<a href="/blog/" class="whosonfirst-nav-link whosonfirst-nav-link-collapsed">blog</a>
							</li>
						</ul>
					</div>
				</div>
			</nav>


		<style type="text/css">
		  body {
		  font-family: serif;
		  font-size: 1.3em;
		  line-height: 1.5em;
		  }

		  h2 small {
		  display: block;
		  margin-top:.10em;
		  font-weight: 100;
		  font-size: .5em;
		  line-height: 1.3em;
		  }

		  p {
		  line-height: 1.5em !important;
		  }

		  ul {
		  font-size:1.3em;
		  line-height:1.5em;
		  margin-top:1em !important;
		  }

		  li {
		  list-style-type: circle;
		  margin-bottom: .5em;
		  }

		  img {
		  max-width: 640px !important;
		  max-height: 480px !important;
		  border: 1px dotted #ccc;
		  padding: .5em;
		  margin-bottom:1em;
		  margin-top: 1em;
		  display:block;
		  min-width: 320px;
		  margin: 0 auto;
		  }

		  blockquote {
		  background-color:#ededed;
		  margin-top:1em;
		  padding-top:.05em !important;
		  padding-bottom:1.75em !important;
		  }

		  .hey-look {
		  font-weight: 700;
		  }

		  @media (min-width: 320px) and (max-width: 400px) {

		  ul {
		  margin:0px;
	  	  margin-left:15px;
		  padding:0px;
		  }

		  pre {
		  max-width:250px;
		  overflow:scroll;
		  }

		  img {
		  max-width: 250px !important;
		  max-height: 200px !important;
		  min-width: 75px;
		  }
		  }

		</style>

			<div class="container whosonfirst-subpage-container">
			  <div class="row">
			    <div class="col-lg-1 col-md-1 col-sm-1 col-xs-0">
 			    </div>
			    <div class="col-lg-10 col-md-10 col-sm-10 col-xs-12">
			      <article>

	  
	  
	  <h2>
	    Boundary Issues: Editing Properties in Who&#39;s On First Records
	    <small>This is a blog post by
	      <span class="hey-look">dphiffer</span>
	      that was published on <span class="pubdate"><a href="/blog/2016/10/">Oct</a> <a href="/blog/2016/10/05">05</a>, <a href="/blog/2016/">2016</a></span>
	       and tagged <span class="hey-look">whosonfirst</span>, <span class="hey-look">boundaryissues</span> and <span class="hey-look">data</span></small>
	  </h2>

<p><a href="https://whosonfirst.mapzen.com/">Who‚Äôs On First records</a>, encoded as GeoJSON flat files, have always supported a failure scenario where you can open them up in Microsoft Word, or TextEdit, or <em>your favorite text editor here</em> and save the changes. Or, if you‚Äôre feeling <em>even lazier</em>, you could <a href="https://github.com/whosonfirst-data/whosonfirst-data">go to GitHub</a> and click on the little pencil icon to modify a record in your browser.</p>

<p><img src="images/edit-button.gif" alt="Edit in GitHub" /></p>

<p>As it turns out, these methods can be cumbersome, so we‚Äôve been developing an internal-facing (for now) web-based editor for Who&rsquo;s On First records called <a href="https://github.com/whosonfirst/whosonfirst-www-boundaryissues/">Boundary Issues</a> (shout out to former Mapzen-er <a href="https://twitter.com/lifewinning">Ingrid Burrington</a> for the name‚Äîalso, hey, go <a href="http://www.mhpbooks.com/books/networks-of-new-york/">buy her book</a>). And to be clear, yes, this is a public blog post about a not-yet-public editing tool. It is still just a little too early to open access up to everyone, but we will get there.</p>

<p>Boundary Issues does not yet edit polygon boundaries in the way that <a href="http://www.openstreetmap.org/edit?editor=id">OpenStreetMap&rsquo;s iD editor</a> does. It will do that someday, but right now it‚Äôs primarily for editing GeoJSON <em>properties</em>. Here is an excerpt of the <a href="https://whosonfirst.mapzen.com/data/100/818/405/1/1008184051.geojson">GeoJSON document</a> for the <a href="https://bernalwood.com/2016/08/29/bernal-rock-transformed-into-beloved-poop-emoji/">Poop Emoji Rock</a>:</p>

<pre><code>{
	&quot;type&quot;: &quot;Feature&quot;,
	&quot;geometry&quot;: {
		&quot;coordinates&quot;: [
			-122.411529,
			37.743715
		],
		&quot;type&quot;: &quot;Point&quot;
	},
	&quot;properties&quot;: {
		&quot;geom:latitude&quot;: 37.743715,
		&quot;geom:longitude&quot;: -122.411529,
		&quot;wof:id&quot;: 1008184051,
		&quot;wof:name&quot;: &quot;Poop Emoji Rock&quot;,
		&quot;wof:parent_id&quot;: 420780697,
		&quot;wof:placetype&quot;: &quot;venue&quot;
	}
}
</code></pre>

<p>If you‚Äôre unfamiliar with the Poop Emoji Rock, it is a frequently painted rock that was recently made to look like Unicode character U+1F4A9 ‚ÄúPILE OF POO‚Äù (also known as üí©). As you might expect, it <a href="https://twitter.com/alloftheplaces/status/770793279969374208">has a Who&rsquo;s On First record</a>.</p>

<p><img src="images/poop-emoji-rock.jpg" alt="Poop Emoji Rock" /></p>

<p class="caption">Image courtesy of <a href="https://bernalwood.com/2016/08/29/bernal-rock-transformed-into-beloved-poop-emoji/">Telstar Logistics</a>.</p>

<p>GeoJSON is a specific kind of JSON (a file format for structuring data), which <a href="https://tools.ietf.org/html/rfc7946">specifies</a> that we can expect a handful of predictable top-level properties. GeoJSON makes it easy for a computer to keep descriptions about <em>where a place is</em> (the <code>geometry</code>) separate from descriptions about the <em>qualities of the place</em> (the <code>properties</code>).</p>

<p>The very first feature of Boundary Issues was for choosing a place‚Äôs geometry: <em>click on the map to set the position.</em> (Thanks to <a href="https://github.com/Leaflet/Leaflet.draw">Leaflet.draw</a> for the add-a-pin UI.)</p>

<p><img src="images/drop-pin.gif" alt="Dropping a pin on the map" /></p>

<p>As for what goes in the GeoJSON <code>properties</code> list, it is very open-ended. <a href="https://mapzen.com/blog/who-s-on-first/">Who‚Äôs On First</a> provides some conventions about <a href="https://github.com/whosonfirst/whosonfirst-properties">what and how to encode things in the GeoJSON properties</a>. This is meant to maximize the compatibility of GeoJSON records between a broad variety of applications.</p>

<p>For example, here is how you might add tags to a record using Boundary Issues.</p>

<p><img src="images/add-properties.gif" alt="Adding properties" /></p>

<p>Notice that we‚Äôre using property <em>namespaces</em>. Instead of specifying a <code>tags</code> property, we use <code>wof:tags</code>, meaning it‚Äôs a part of the <a href="https://github.com/whosonfirst/whosonfirst-properties/blob/master/properties/wof.md">Who‚Äôs On First namespace</a>. This lets us keep things that are common to <em>all WOF records</em> like <code>wof:name</code> separate from from Mapzen <em>opinionated things</em> like <code>mz:categories</code>. This namespacing is in the same <a href="https://en.wikipedia.org/wiki/Triplestore">spirit</a> as the <a href="https://en.wikipedia.org/wiki/Semantic_Web">Semantic Web</a>, but without the verbosity of <a href="https://en.wikipedia.org/wiki/Resource_Description_Framework#Examples">RDF</a>.</p>

<p>The namespaces also offer a natural way to group related properties in the user interface.</p>

<p><img src="images/grouped-properties.gif" alt="Grouped properties" /></p>

<p>Unlike the more freestyle approach of <a href="http://geojson.io/">geojson.io</a>,  Boundary Issues has built-in scaffolding that guides how properties get encoded. The user interface is saying ‚Äúhere are some of the things you can type in.‚Äù For example, what are the <a href="https://github.com/whosonfirst/whosonfirst-names">names</a> people are known to call this place? Are there <a href="https://github.com/whosonfirst/whosonfirst-properties/blob/master/properties/wof.md#concordances">concordances to records in other databases</a> we can hold hands with?</p>

<p>Boundary Issues also keeps a short list of <em>minimal viable properties</em> that are required to make a Who‚Äôs On First record. When creating a <a href="https://github.com/whosonfirst/whosonfirst-placetypes/blob/master/placetypes/venue.json">venue placetype</a> you can pretty much drop a pin on the map, type in a <code>wof:name</code> value, and you‚Äôve got yourself a WOF record. All the other properties are optional, and will be assigned reasonable default values.</p>

<p>We turned to <a href="http://json-schema.org/">JSON Schema</a>, <em>yet another flavor of JSON</em>, to define how different properties get encoded. JSON Schema was originally created as a way of declaring guidelines that say <em>this is VALID</em> or <em>this is INVALID</em>. Using it for that purpose does have <a href="https://www.tbray.org/ongoing/When/201x/2016/04/30/JSON-Schema-funnies">some complications</a>, but the specification files themselves can be read by a variety of programming languages. It lets us build a basic scaffolding for records that isn‚Äôt tied into any one particular application.</p>

<p>We can use the schema to construct a brand new empty record, and to nudge each of its properties into their intended data types (strings, numbers, lists, etc.), and provide a default value when we need one. Perhaps we will use our JSON Schema for validating records some day.</p>

<p>Here&rsquo;s an excerpt from <a href="https://github.com/whosonfirst/whosonfirst-json-schema/blob/master/schema/whosonfirst.schema">our schema</a> (derived from <a href="https://github.com/fge/sample-json-schemas/blob/master/geojson/geojson.json">this sample GeoJSON schema</a>):</p>

<pre><code>{
	&quot;properties&quot;: {
		&quot;wof:id&quot;: {
			&quot;type&quot;: &quot;integer&quot;
		},
		&quot;wof:parent_id&quot;: {
			&quot;type&quot;: &quot;integer&quot;,
			&quot;default&quot;: -1
		},
		&quot;wof:name&quot;: {
			&quot;type&quot;: &quot;string&quot;
		}
	}
}
</code></pre>

<p>The way the property-editing interface <em>behaves</em> requires an additional set of <a href="https://github.com/whosonfirst/whosonfirst-www-boundaryissues/blob/master/www/include/lib_wof_render.php#L44-L133">guidelines</a>. These rules <em>are</em> baked into the source code (since they‚Äôre specific to Boundary Issues), and they let us specify things on a per-property basis like:</p>

<ul>
<li>Is the property <em>editable</em>? If not, the property should be set by software automatically.</li>
<li>Is the property <em>deletable</em>? Which is really just another way of saying ‚Äúthis property is required, <em>it must have a value of some sort</em>.‚Äù</li>
<li>Is the property <em>visible</em>? Almost all properties are visible in the list, but sometimes it‚Äôs helpful to hide them from the editing interface.</li>
<li>Is the property on the short list of <em>minimum viable properties</em>?</li>
</ul>

<p>Collectively these data types, default values, and editing behaviors get baked into an HTML <code>&lt;form&gt;</code> element, with various clues for the JavaScript code about how it should treat each property.</p>

<pre><code>&lt;div class=&quot;json-schema-field json-schema-required&quot;&gt;
	&lt;input type=&quot;text&quot; name=&quot;properties.wof:parent_id&quot; value=&quot;-1&quot;
	       disabled=&quot;disabled&quot; data-type=&quot;integer&quot;&gt;
&lt;/div&gt;
</code></pre>

<p><img src="images/minimum-viable.png" alt="Minimum Viable Properties / Add a new property" /></p>

<p>In the case of <code>wof:parent_id</code>, you might wonder how it can be both <em>required</em> and also <em>disabled</em>? With these constraints, how could the value ever change from the default value? The answer is in our growing assortment of bespoke editing interfaces, discussed below.</p>

<p>In the case of <code>wof:parent_id</code> and <code>wof:hierarchy</code>, these values are chosen automatically thanks to our internal <a href="https://github.com/whosonfirst/go-whosonfirst-pip">point in polygon service</a>. After dropping a pin on the map, the code consults with the point in polygon service, then suggests a potential hierarchy (or <em>hierarchies</em>, <a href="https://github.com/whosonfirst/whosonfirst-placetypes#hierarchies">there can be more than one</a>).</p>

<p><img src="images/hierarchy.png" alt="Hierarchy" /></p>

<p>The hierarchy interface doesn‚Äôt actually offer any new user-facing controls, instead it just kind of <a href="http://lifewinning.com/tag/magic/"><em>does stuff</em></a>, encoding properties behind the scenes based on the chosen latitude and longitude coordinates. There are some additional bespoke property interfaces within the UI that make it easier to express things that don‚Äôt sit neatly inside of text input boxes. Recent additions include a multi-language name editor, an address parsing widget, a way of encoding a venue‚Äôs open and closing hours, and a way of encoding venue categories. We hope some of these UI widgets‚Äîsuch as the address parsing one‚Äîwill eventually get extracted out into a generalized JavaScript library for use outside of Boundary Issues.</p>

<div class="row">
	<div class="col-sm-6"><img src="images/libpostal_bi_address.gif" alt="Address"></div>
	<div class="col-sm-6"><img src="images/names.gif" alt="Names"></div>
</div>
<div class="row">
	<div class="col-sm-6"><img src="images/category.gif" alt="Categories"></div>
	<div class="col-sm-6"><img src="images/hours.gif" alt="Hours"></div>
</div>

<p>Boundary Issues is still very much a wet-paint prototype, but it‚Äôs making steady progress. There is a growing backlog of <a href="https://github.com/whosonfirst/whosonfirst-www-boundaryissues/issues">issues</a> to work through, and plenty of Who‚Äôs On First records that need some TLC. We&rsquo;ll get there, and once the editor is a little more mature we&rsquo;ll be sure to invite you to give it a try!</p>

		</article>
		</div>
		</div>	
		</div>	

		<footer>
			<nav class="navbar navbar-default navbar-bottom">
				<div class="container">
					
					<ul class="nav navbar-nav navbar-right whosonfirst-footer">
						<li><a href="/docs/contributing/" class="whosonfirst-nav-link whosonfirst-footer-nav-link">contributing</a></li>
						<li><a href="/docs/licenses/" class="whosonfirst-nav-link whosonfirst-footer-nav-link">license</a></li>
						<li><a href="https://twitter.com/alloftheplaces/" class="whosonfirst-nav-link whosonfirst-footer-nav-link">twitter</a></li>
					</ul>
				</div>
			</nav>
		</footer>

		
		<script src="/javascript/jquery.min.js"></script>
		
		<script src="/javascript/bootstrap.min.js"></script>
		<script src="/javascript/mapzen.whosonfirst.home.js"></script>
		<script src="/javascript/mapzen.whosonfirst.subpage.js"></script>
		
		<script src="/javascript/highlightpack.js"></script>
		<script>
		  try {
		  	hljs.initHighlightingOnLoad();
		  } catch (e) {
		  	console.log("HLJS", e);
		  }
		</script>
	</body>
</html>

