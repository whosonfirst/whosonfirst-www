<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="x-ua-compatible" content="ie=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Whos On First Updates, 2017</title>
		<meta name="description" content="Who’s on First is a gazetteer of places.">
		
		<link rel="stylesheet" href="/css/bootstrap.min.css">
		<link rel="stylesheet" href="/css/mapzen.whosonfirst.css">
		
		<link rel="stylesheet" href="/css/styles/grayscale.css">

		<meta property="og:type" content="article" />
		<meta property="og:site_name" content="Who's On First" />
		<meta property="og:title" content="Whos On First Updates, 2017" />
		<meta property="og:description" content="Outlining a few one-offs, changes, and edits that were made to Who&#39;s On First in 2017" />
		<meta property="og:image" content="https://www.whosonfirst.org/blog/2017/12/14/updating-whosonfirst/&#34;images/eraser.jpg&#34;" />
		
		<meta property="twitter:card" value="summary" />
		<meta property="twitter:site" content="@alloftheplaces" />
		<meta property="twitter:creator" content="@alloftheplaces" />
		<meta property="twitter:url" content="https://www.whosonfirst.org/blog/2017/12/14/updating-whosonfirst/" />
		<meta property="twitter:title" content="Whos On First Updates, 2017" />
		<meta property="twitter:description" content="Outlining a few one-offs, changes, and edits that were made to Who&#39;s On First in 2017" />
		<meta property="twitter:image" content="https://www.whosonfirst.org/blog/2017/12/14/updating-whosonfirst/&#34;images/eraser.jpg&#34;" />
		
		<style type="text/css">
		  body {
		  font-family: serif;
		  margin:2em;
		  margin-left: 10%;
		  margin-right: 10%;
		  font-size: 1.3em;
		  line-height: 1.5em;
		  }

		  img {
		  max-width: 640px !important;
		  max-height: 480px !important;
		  border: 1px dotted #ccc;
		  padding: .5em;
		  margin-bottom:1em;
		  margin-top: 1em;
		  }

		  h2 small {
		  display: block;
		  margin-top:.10em;
		  font-weight: 100;
		  font-size: .5em;
		  }

		  .hey-look {
		  font-weight: 700;
		  }

		  #blog-post {
		  margin-top:2em;
		  margin-bottom:5em;
		  }
		  
		</style>
	</head>
	<body>

	  
	  
	  <h2>
	    Whos On First Updates, 2017
	    <small>This is a blog post by
	      <span class="hey-look">stepps00</span>
	      that was published on December 14, 2017 
	       and tagged <span class="hey-look">whosonfirst</span> and <span class="hey-look">data</span></small>
	  </h2>

	  <div id="blog-post">
<div style="margin: 0 auto; width:640px;">
<a href="images/eraser.jpg"><img src="images/eraser.jpg" height="360" width="640" /></a>
</div>

<h2>So, what&rsquo;s new in Who&rsquo;s On First?</h2>

<p>Before the year&rsquo;s end, I wanted to take a few moments to describe three issues that we&rsquo;ve recently tackled in Who&rsquo;s On First. While many of the data issues in Who&rsquo;s On First can be complex, each issue has to be addressed with a unique set of tools, a specific workflow, and should follow simple rules that we&rsquo;ve outlined to ensure our changes and adjustments can be added to the database.</p>

<p>We&rsquo;ve tackled many large-scale issues in 2017, from the <a href="https://mapzen.com/blog/introducting-statoids/">Statoids and Mesoshapes imports</a>, to <a href="https://mapzen.com/blog/neighbourhood-updates-two/">updating neighbourhood records</a>, to the <a href="https://mapzen.com/blog/summer-2017-wof/">GeoNames name localization</a> work. I wanted to outline a few of the smaller issues we&rsquo;ve dealt with in the past few months, and describe what it took to fix the issues.</p>

<p>The issues are below, each with a brief description of the problem and solution. Take a look and enjoy!</p>

<h2>Santa Barbara Neighbourhoods</h2>

<p>In October, <a href="https://github.com/whosonfirst-data/whosonfirst-data/issues/997">a user reported</a> that the record for the neighbourhood of Midco in California had <a href="https://github.com/whosonfirst-data/whosonfirst-data/blob/028f288cc2a2995edb819a90d395a73c553017b0/data/420/552/455/420552455.geojson">a <em>large</em> geometry</a>. So large, in fact, the geometry spanned some 50+ miles, from Santa Maria, CA to Santa Barbara, CA. This geometry was causing the <a href="https://mapzen.com/blog/whosonfirst-api/">Who&rsquo;s On First API</a> to return peculiar hierarchy results for this area.</p>

<p>This geometry issue was two-fold; first, we needed to shrink the size of the Midco neighbourhood geometry down to a size that actually represents Midco and secondly, we needed to find a source for new neighbourhood records in Santa Barbara (Midco covered the entire city of Santa Barbara).</p>

<p>Once Midco was <a href="https://whosonfirst.mapzen.com/spelunker/id/420552455/">cut down to size</a>, <a href="https://github.com/whosonfirst/whosonfirst-sources/blob/master/sources/santabar.json">openly licensed</a> neighbourhood data on <a href="https://maps.santabarbaraca.gov/Html5Viewer/Index.html?configBase=/Geocortex/Essentials/REST/sites/City_of_Santa_Barbara__Public/viewers/SantaBarbaraPublic/virtualdirectory/Resources/Config/Default">Santa Barbara&rsquo;s website</a> was found. After downloading the neighbourhood data, I was able to mint new <code>wof:id</code> values (thank you, <a href="www.brooklynintegers.com">Brooklyn Integers</a> for new Who&rsquo;s On First records), map the source properties into applicable Who&rsquo;s On First <a href="https://github.com/whosonfirst/whosonfirst-properties/tree/master/properties">properties</a>, and import them as new records!</p>

<p>To download Santa Barbara neighbourhoods, use our Bundler tool, <a href="https://whosonfirst.mapzen.com/spelunker/download/85921779/?exclude=nullisland">here</a> or take a look at the geometries below!</p>

<div class="demo-wrapper" style="height: 60vh; width: 80vw; margin-left: calc(50% - 40vw);">
    <iframe src="https://tangrams.github.io/tangram-frame/?noscroll&url=https://s3.amazonaws.com/mapzen-assets/images/wof-updates/santabarbara.yaml#12.0000/34.4331/-119.7546">
    Your browser doesn't support iframe, <a href="https://tangrams.github.io/tangram-frame/?noscroll&url=https://s3.amazonaws.com/mapzen-assets/images/wof-updates/santabarbara.yaml#12.0000/34.4331/-119.7546" target="_blank">click here to see demo</a></iframe>
</div>

<p><em>Above: New neighbourhood records for Santa Barbara, CA.</em></p>

<h2>Australia Regions</h2>

<p>While the type of geometry and property updates in Australia are not new to Who&rsquo;s On First, they represent the type of updates that many Who&rsquo;s On First records have received in the past and what many records will receive in the future. In a <a href="https://github.com/whosonfirst-data/whosonfirst-data/pull/688">pull request</a> in the <code>whosonfirst-data</code> repository, new geometries were added to the records for regions in Australia.</p>

<p>To do this, the source data from <a href="https://github.com/whosonfirst/whosonfirst-sources/blob/master/sources/austriaod.json">Australia Open Data</a> was loaded into <a href="https://www.qgis.org/en/site/">QGIS</a>. A new property field was added to the source data with the corresponding <code>wof:id</code> for each feature; this is essentially allows us to &ldquo;link&rdquo; the new source data features to the existing Who&rsquo;s On First records. Then, using a simple Python script, the geometries for each Who&rsquo;s On First record were updated and existing geometries were saved as alt-geometry files.</p>

<p>And, just like that, Australia regions were updated!</p>

<p>An example of these geometry updates is shown below. Zooming out, you&rsquo;ll see the older, less detailed geometry we maintained for Christmas Island. Zooming in, you&rsquo;ll see the new, more detailed geometry - quite the improvement!</p>

<div class="demo-wrapper" style="height: 60vh; width: 80vw; margin-left: calc(50% - 40vw);">
    <iframe src="https://tangrams.github.io/tangram-frame/?noscroll&url=https://s3.amazonaws.com/mapzen-assets/images/wof-updates/christmasisland.yaml#12.0000/-10.4778/105.6241">
    Your browser doesn't support iframe, <a href="https://tangrams.github.io/tangram-frame/?noscroll&url=https://s3.amazonaws.com/mapzen-assets/images/wof-updates/christmasisland.yaml#12.0000/-10.4778/105.6241" target="_blank">click here to see demo</a></iframe>
</div>

<p><em>Above: Comparison of region geometries for Christmas Island.</em></p>

<h2>Leningrad and St Petersburg</h2>

<p>Piggy-backing on the historical administrative work we started in <a href="https://whosonfirst.mapzen.com/spelunker/id/1108955789/">Yugoslavia</a>, we adjusted records in and around <a href="https://whosonfirst.mapzen.com/spelunker/id/1158857531/">St. Petersburg, Russia</a> to reflect the administrative changes in that area since the <a href="https://en.wikipedia.org/wiki/Saint_Petersburg#Revolution_and_Soviet_Era_(1917–1941">Russian Revolution</a>).</p>

<p><a href="https://github.com/whosonfirst-data/whosonfirst-data/issues/948">An issue was filed</a> in the <code>whosonfirst-data</code> repository, letting us know there were two distinct records in Who&rsquo;s On First for St. Petersburg - one for St. Petersburg and one for Leningrad. Upon further inspection, we actually had four duplicate records in that area, all of which were merged, superseded, and updated.</p>

<p>Take a look at the record for the St. Petersburg locality, <a href="https://whosonfirst.mapzen.com/spelunker/id/1158857531/">here</a>.</p>

<h3>Wrapping Up</h3>

<p>And, with that, I hope this is given you insight into the daily workings of geometry and property issues in Who&rsquo;s On First!</p>

<p>As always, if you would like to contribute to Who&rsquo;s On First, file a new issue in the <a href="https://github.com/whosonfirst-data/whosonfirst-data/issues/new">whosonfirst-data</a> repository or <a href="mailto:hello@mapzen.com">drop us a line</a>!</p>

<p><em>Photo Credit: <a href="https://flic.kr/p/mAYbSi">Carol VanHook. (Flickr, CC BY 2.0)</a></em></p>
</div>
</body>
</html>
